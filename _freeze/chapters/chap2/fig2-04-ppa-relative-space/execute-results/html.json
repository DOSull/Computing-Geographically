{
  "hash": "83e42ceb284897ed88d1d348e78e66ff",
  "result": {
    "markdown": "---\ntitle: \"Figure 2.4: Two point patterns in absolute space\"\nexecute: \n  cache: true\n  freeze: auto\n---\n\n\nAlthough it is labelled 'point patterns in absolute space', the real (ahem) _point_ of this figure is that spatial analysis often works, in effect, with a relative concept of space, since it is based on notions as here, such as the distances between points.\n\nIf you want point patterns, you need [the fantastic `spatstat`](https://github.com/spatstat) by Adrian Baddeley, Ege Rubak, and Rolf Turner.\n\n\n::: {.cell hash='fig2-04-ppa-relative-space_cache/html/unnamed-chunk-1_d48eaa928b0649ac9c5cdff7ccbfd09f'}\n\n```{.r .cell-code}\nlibrary(spatstat)\n```\n:::\n\n\nMake a couple of point patterns, one evenly-space using _sequential spatial inhibition_, and one clustered using a _Thomas process_. For the latter, see\n\n> Thomas M. 1949. A generalisation of Poisson's binomial limit for use in ecology. _Biometrika_ **36**, 18â€“25.\n\n\n::: {.cell hash='fig2-04-ppa-relative-space_cache/html/unnamed-chunk-2_1d0a2c319a4333dce2db8d5d00684ddf'}\n\n```{.r .cell-code}\npp1 <- rSSI(0.07, n = 105)\npp2 <- rThomas(10, 0.03, 10)\n```\n:::\n\n\nCalculate nearest neighbour distances.\n\n\n::: {.cell hash='fig2-04-ppa-relative-space_cache/html/unnamed-chunk-3_2fed7e19066c20dd184d75d76e323d5f'}\n\n```{.r .cell-code}\nnn1 <- nndist(pp1)\nnn2 <- nndist(pp2)\nbreaks <- seq(0, max(nn2), length.out = 10)\n```\n:::\n\n\nAnd plot them.\n\n\n::: {.cell hash='fig2-04-ppa-relative-space_cache/html/unnamed-chunk-4_7d332fb62a4c6affeefb55abdbb8e019'}\n\n```{.r .cell-code}\npar(mfrow = c(2, 2), mai = rep(0.3, 4))\n\nplot(pp1, main = \"\")\nhist(nn1, main = \"\", xlab = \"Distance\", ylab = \"Frequency\", breaks = breaks)\nplot(pp2, main = \"\")\nhist(nn2, main = \"\", xlab = \"Distance\", ylab = \"Frequency\", breaks = breaks)\n```\n\n::: {.cell-output-display}\n![](fig2-04-ppa-relative-space_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n::: {.cell hash='fig2-04-ppa-relative-space_cache/html/unnamed-chunk-5_403a0011fa9fb8bd107386a71f6c5841'}\n\n```{.r .cell-code  code-fold=\"true\"}\n# License (MIT)\n#\n# Copyright (c) 2023 David O'Sullivan\n#\n# Permission is hereby granted, free of charge, to any person\n# obtaining a copy of this software and associated documentation\n# files (the \"Software\"), to deal in the Software without restriction,\n# including without limitation the rights to use, copy, modify, merge,\n# publish, distribute, sublicense, and/or sell copies of the Software,\n# and to  permit persons to whom the Software is furnished to do so,\n# subject to the following conditions:\n#\n# The above copyright notice and this permission notice shall be included\n# in all copies or substantial portions of the Software.\n#\n# THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n# OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n# FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL\n# THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n# LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n# FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n# DEALINGS IN THE SOFTWARE.\n```\n:::",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}