{
  "hash": "aabc8f71ad94348f9691019e83ac0078",
  "result": {
    "markdown": "---\ntitle: \"Figure 2.4 Two point patterns in absolute space\"\ncategories: \n  - figures\n  - code\n  - R\nexecute: \n  cache: true\n  freeze: auto\nknitr:\n  opts_chunk: \n    warning: false\n    message: false\n---\n\n\nAlthough it is labelled 'point patterns in absolute space', the real (ahem) _point_ of this figure is that spatial analysis often works, in effect, with a relative concept of space, since it is based on notions as here, such as the distances between points.\n\nIf you want point patterns, you need [the fantastic `spatstat`](https://github.com/spatstat) by Adrian Baddeley, Ege Rubak, and Rolf Turner.\n\n\n::: {.cell hash='fig2-04-ppa-relative-space_cache/html/unnamed-chunk-1_d9665f150ebc01b59e617d6630096509'}\n\n```{.r .cell-code}\nlibrary(spatstat)\n```\n:::\n\n\nMake a couple of point patterns, one evenly-space using _sequential spatial inhibition_, and one clustered using a _Thomas process_. For the latter, see\n\n> Thomas M. 1949. A generalisation of Poisson's binomial limit for use in ecology. _Biometrika_ **36**, 18â€“25.\n\n\n::: {.cell hash='fig2-04-ppa-relative-space_cache/html/unnamed-chunk-2_76500446864586cb031d5b516acd1617'}\n\n```{.r .cell-code}\npp1 <- rSSI(0.07, n = 105)\npp2 <- rThomas(10, 0.03, 10)\n```\n:::\n\n\nCalculate nearest neighbour distances.\n\n\n::: {.cell hash='fig2-04-ppa-relative-space_cache/html/unnamed-chunk-3_f8fdb61d81f461cc0b042c7043928422'}\n\n```{.r .cell-code}\nnn1 <- nndist(pp1)\nnn2 <- nndist(pp2)\nmax_d <- ceiling(max(c(nn1, nn2)) * 10) / 10\nbreaks <- seq(0, max_d, length.out = 10)\n```\n:::\n\n\nAnd plot them.\n\n\n::: {.cell hash='fig2-04-ppa-relative-space_cache/html/unnamed-chunk-4_3beb3a3d606fdffd6b3a007d9c8a7634'}\n\n```{.r .cell-code}\npar(mai = rep(0.3, 4))\nlayout(matrix(1:4, 2, 2, byrow = TRUE))\n\nplot(pp1, main = \"\")\nhist(nn1, main = \"\", xlab = \"Distance\", ylab = \"Frequency\", breaks = breaks)\nplot(pp2, main = \"\")\nhist(nn2, main = \"\", xlab = \"Distance\", ylab = \"Frequency\", breaks = breaks)\n```\n\n::: {.cell-output-display}\n![](fig2-04-ppa-relative-space_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n::: {.cell hash='fig2-04-ppa-relative-space_cache/html/unnamed-chunk-5_a148bdfe7ed1dcd417141d1c7d56b299'}\n\n```{.r .cell-code  code-fold=\"true\"}\n# License (MIT)\n#\n# Copyright (c) 2023 David O'Sullivan\n#\n# Permission is hereby granted, free of charge, to any person\n# obtaining a copy of this software and associated documentation\n# files (the \"Software\"), to deal in the Software without restriction,\n# including without limitation the rights to use, copy, modify, merge,\n# publish, distribute, sublicense, and/or sell copies of the Software,\n# and to  permit persons to whom the Software is furnished to do so,\n# subject to the following conditions:\n#\n# The above copyright notice and this permission notice shall be included\n# in all copies or substantial portions of the Software.\n#\n# THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n# OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n# FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL\n# THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n# LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n# FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n# DEALINGS IN THE SOFTWARE.\n```\n:::",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}