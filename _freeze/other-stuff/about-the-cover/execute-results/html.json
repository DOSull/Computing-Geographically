{
  "hash": "aa46185fbfd526736c4e26100a3b5fab",
  "result": {
    "markdown": "---\ntitle: About the cover\nsubtitle: And how to make your own\ndescription: \"An explanation of how the I made the cover art\"\ndate: \"10/19/2023\"\ndate-modified: \"10/25/2023\"\ncategories:\n  - extras\n  - code\n  - R\nexecute: \n  cache: true\n  freeze: auto\nknitr:\n  opts_chunk: \n    warning: false\n    message: false\n---\n\n\n::: {.callout-note collapse=\"true\"}\n#### Update History\n\n| Date       | Changes                                                                |\n|:-----------|:-----------------------------------------------------------------------|\n| 2023-10-25 | Removed offsetting to centre of NZTM projection. Added Update history. |\n| 2023-10-24 | Inverted coordinates to make landscape images.                         |\n| 2023-10-19 | Initial post.                                                          |\n\n:::\n\n## The idea behind the cover\nLoosely speaking the cover mirrors the sequence from _simple location_ to _world as relational process_ that the book recounts. A set of relationally interacting, moving, simple locations converge to become a Whitehead-ian 'society of actual occasions'. If you have no idea what I'm on about, you'll have to read the book...\n\nIn any case, I like how the artwork looks, and so did the publisher!\n\nHere's how I made it (flipped to landscape mode so you get bigger pictures).\n\n## A flocking model\nThe starting point was a *flocking model*, which is discussed in Chapter 8 of the book, in &sect;**Agent-Based Models**, but also makes an appearance in Figure 7.7. This model was previously made for my earlier book _Spatial Simulation_ written with George Perry, which you can find all about [here](https://patternandprocess.org). Specifically [this NetLogo model](https://dosull.github.io/pattern-and-process/chapter-4/4.7.html) appears in the [model zoo](https://dosull.github.io/pattern-and-process/#the-model-zoo), as an implementation of ideas in these papers\n\n> Czirók A and T Vicsek. 2000. Collective behavior of interacting self-propelled particles. _Physica A: Statistical Mechanics and its Applications_ **281** 17–29.\n\n> Grégoire G, H Chaté and Y Tu. 2003. Moving and staying together without a leader. _Physica D: Nonlinear Phenomena_ **181** 157–70.\n\n> Vicsek T, A Czirók, E Ben-Jacob, I Cohen and O Sochet. 1995. Novel type of phase transition in a system of self-driven particles. _Physical Review Letters_ **75** 1226–29.\n\nYou can play with a&mdash;rather slow, because the web version is slow&mdash;version of that model [here](https://southosullivan.com/misc/4.7-flocking.html). If you download and run it locally, you'll find some commented out code at the end that implements a `save-history` procedure that means you can run the model for a bit then get a CSV file with `who`, `x`, `y`, and `t` output for the flockers, which is the basis for the cover art. `who` is NetLogo's endearing default variable name that we would more often think of as 'ID' or similar. It's because the moving things in NetLogo are _turtles_, not mere simple locations. This puts me in mind of Gillian Rose and Torsten Hägerstrand's thoughts on the living bodies at the tips of space-time paths, as discussed in &sect;**Limits to Time Geography** in [Chapter 7](../chapters/chap7/index.qmd).\n\n## The space-time traces\nSo, after importing some packages, read in one of those output files. There's an [example here](traces.csv), should you wish to make your own alternative cover.\n\n\n::: {.cell hash='about-the-cover_cache/html/unnamed-chunk-1_718dfebf7df1152fa54ecf3f8e4e7824'}\n\n```{.r .cell-code}\nlibrary(sf)\nlibrary(tmap)\nlibrary(dplyr)\nlibrary(units)\n\nxy <- read.table(\"traces.csv\", sep = \" \", header = TRUE)\n```\n:::\n\n\nWe don't need all the time steps in that file, so cut it down a bit and convert into a simple features dataset. You'll note that even though these are not real world data (this is a book cover after all) I have to assign a projection, so that some of the later steps in the process will cooperate. The curse of geodetic accuracy strikes again!\n\n\n::: {.cell hash='about-the-cover_cache/html/unnamed-chunk-2_b452fdf19a2880eb63bafa0eb60b1610'}\n\n```{.r .cell-code}\nsteps <- seq(1, 50, 1)\n\nxy_sf <- xy %>%\n  filter(t %in% steps) %>%\n  st_as_sf(coords = c(\"y\", \"x\"), crs = 2193)\n```\n:::\n\n\nBefore we go any further, we need a 'frame' for all the layers we'll be using, so this is made from the extent of the included points, inset a little. Insetting avoids some otherwise strange edge effects.\n\n\n::: {.cell hash='about-the-cover_cache/html/unnamed-chunk-3_3c1218a977f7bbff741532f4406585c2'}\n\n```{.r .cell-code}\nxy_inset <- xy_sf %>%\n  st_bbox() %>%\n  st_as_sfc() %>%\n  st_sf() %>%\n  st_set_crs(2193) %>%\n  st_buffer(-.5)\n```\n:::\n\n\nThe underlying basis of the cover art is those traces, which we need to form into a lines dataset and clip to the frame.\n\n\n::: {.cell hash='about-the-cover_cache/html/unnamed-chunk-4_af3e6e0f1c256bd9bbb9a7e69e0a2474'}\n\n```{.r .cell-code}\nxy_path <- xy_sf %>%\n  group_by(who) %>%\n  summarise(do_union = FALSE) %>%\n  st_cast(\"LINESTRING\") %>% \n  st_intersection(xy_inset)\n```\n:::\n\n\nSo this is what we've got so far:\n\n\n::: {.cell hash='about-the-cover_cache/html/unnamed-chunk-5_211ee60bffcd8c95504ef3dea9b69d44'}\n\n```{.r .cell-code}\ntm_shape(xy_path) + \n  tm_lines(lwd = 0.5)\n```\n\n::: {.cell-output-display}\n![](about-the-cover_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n## Voronoi polygons of the trajectory points\nProbably you can tell that some [Voronoi magic](../chapters/chap2/fig2-07-point-voronoi.qmd) was involved, specifically Voronoi polygons of the points along the trajectories, in a manner reminiscent of the [Voronois along the road centre line in Figure 2.8](../chapters/chap2/fig2-08-non-point-voronoi.qmd).\n\n\n::: {.cell hash='about-the-cover_cache/html/unnamed-chunk-6_8bca3d72758e39b948f1fd1695dac206'}\n\n```{.r .cell-code}\nxy_vor <- xy_sf %>%\n  st_union() %>%\n  st_voronoi() %>%\n  st_cast() %>%\n  st_as_sf(crs = st_crs(xy_sf)) %>%\n  st_join(xy_sf) %>%\n  st_intersection(xy_inset) %>%\n  distinct(geometry)\n```\n:::\n\n\nAnd here is what we have got so far:\n\n\n::: {.cell hash='about-the-cover_cache/html/unnamed-chunk-7_9262bd0543f5a91182a1a2c5c9d1b4b3'}\n\n```{.r .cell-code}\ntm_shape(xy_vor) +\n  tm_borders(col = \"blue\", lwd = 0.35) +\n  tm_shape(xy_path) + \n  tm_lines(lwd = 0.5)\n```\n\n::: {.cell-output-display}\n![](about-the-cover_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\nwhich is already pretty interesting looking.\n\n## Overlapping Voronoi polygons\nThe cover depends on overlapping the Voronoi polygons, which when coloured with some transparency gives the final effect. So some buffering (the original sin of GIS!) required. I decided after much experimentation to make the buffers larger for the bigger polygons.\n\n\n::: {.cell hash='about-the-cover_cache/html/unnamed-chunk-8_80562949b28d611be38d209151a85b34'}\n\n```{.r .cell-code}\nxy_vor_b <- xy_vor %>%\n  mutate(area = st_area(.), r = as_units(.25, \"m\") + sqrt(area / pi)) %>%\n  st_buffer(.$r) %>%\n  st_intersection(xy_inset)\n```\n:::\n\n\nIn itself this is also interesting to look at:\n\n\n::: {.cell hash='about-the-cover_cache/html/unnamed-chunk-9_14c997b496cfebdafb39ca5b10eb2c17'}\n\n```{.r .cell-code}\ntm_shape(xy_vor_b) + \n  tm_borders(lwd = 0.15)\n```\n\n::: {.cell-output-display}\n![](about-the-cover_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n## Putting it all together\nArmed with those three layers, we can do all kinds of interesting compositions. It's fun to play with the colour palettes, the transparency, the direction of the ramps, and any number of other things. Here's what I wound up using:\n\n\n::: {.cell hash='about-the-cover_cache/html/unnamed-chunk-10_7f02b5b9796d7f6482f382a3c23fa1f3'}\n\n```{.r .cell-code}\ntm_shape(xy_vor_b)  +\n  tm_polygons(col = \"r\", alpha = 0.3, style = \"cont\", lwd = 0,\n              palette = \"-plasma\", legend.show = FALSE) +\n  tm_shape(xy_vor) +\n  tm_borders(col = \"white\", alpha = 0.35, lwd = 0.35) +\n  tm_shape(xy_path) +\n  tm_lines(col = \"white\", palette = \"Blues\", lwd = 1, alpha = 0.5) +\n  tm_layout(frame = FALSE, bg.color = \"white\")\n```\n\n::: {.cell-output-display}\n![](about-the-cover_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n## Other computational art in _R_\nComputational 'generative' art is a lot of fun. I'd have to rewrite that NetLogo model in _R_ to make this truly an example of generative art in _R_, but _en route_ to this approach I found some interesting resources here, particularly\n\n- [Nicola Rennie's 'Rtistry'](https://nrennie.rbind.io/portfolio/rtistry/)\n- [Koen Derks's `aRtsy` package](https://github.com/koenderks/aRtsy)\n\nIn the end I preferred the greater control that my own 'tool-chain' gave me.\n\n\n::: {.cell hash='about-the-cover_cache/html/unnamed-chunk-11_4e7a5c1df7a3b1b7d84015cd102e9bdd'}\n\n```{.r .cell-code  code-fold=\"true\"}\n# License (MIT)\n#\n# Copyright (c) 2023 David O'Sullivan\n#\n# Permission is hereby granted, free of charge, to any person\n# obtaining a copy of this software and associated documentation\n# files (the \"Software\"), to deal in the Software without restriction,\n# including without limitation the rights to use, copy, modify, merge,\n# publish, distribute, sublicense, and/or sell copies of the Software,\n# and to  permit persons to whom the Software is furnished to do so,\n# subject to the following conditions:\n#\n# The above copyright notice and this permission notice shall be included\n# in all copies or substantial portions of the Software.\n#\n# THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n# OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n# FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL\n# THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n# LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n# FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n# DEALINGS IN THE SOFTWARE.\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}